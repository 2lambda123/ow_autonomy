// The Notices and Disclaimers for Ocean Worlds Autonomy Testbed for Exploration
// Research and Simulation can be found in README.md in the root directory of
// this repository.

#include "plan-interface.h"

LibraryAction IdentifySampleTarget (InOut Real X,
                                    InOut Real Y,
                                    InOut Boolean Parallel,
                                    InOut Real GroundPos);

BasicFaultHandlingSearch:
{
  In Boolean battery_ok, arm_ok, power_ok, search_interrupted;
  InOut Boolean first_search_call;

  // These 4 variables are assigned in the call to IdentifySampleTarget.
  Real trench_x, trench_y, ground_pos;
  Boolean parallel;

  Repeat first_search_call || search_interrupted;
  Start battery_ok && arm_ok && power_ok;
  ExitCondition !(battery_ok && arm_ok && power_ok);
  log_info ("Library calling search...");
  log_info ("** Identifying Sample Target **");
  LibraryCall IdentifySampleTarget (X = trench_x,
                                  Y = trench_y,
                                  GroundPos = ground_pos,
                                  Parallel = parallel);

  if first_search_call
  {
  first_search_call = false;
  }
}

